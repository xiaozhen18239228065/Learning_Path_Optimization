import matplotlib as mpl
from matplotlib import pyplot as plt
import matplotlib.cm as cm  # 导入Matplotlib颜色配置模块
import matplotlib.patches as patches  # 导入Matplotlib形状绘制模块

def draw_scatter_f1(electra_results, bert_results, titles):
    font_size = 5
    font_en = 'DejaVu Sans'
    # for transformer_y, bert_y, title in zip(transformer_results, bert_results, titles):
    for electra_y, bert_y, title in zip(electra_results, bert_results, titles):
        fig, ax = plt.subplots()
        sort_zipped = sorted(zip(electra_y, bert_y), key=lambda x:(x[0], x[1])) # if x[0] is equal, sort by x[1]
        electra_y, bert_y = zip(*sort_zipped)
        ax.scatter(range(1, 98), electra_y, label=model_name,marker='o', s=14.0, color='#1f77b4')#color='#d62728')#
        ax.scatter(range(1, 98), bert_y,label='BERT-MDCF',marker='^', s=14.0, color='#d62728')#color='#1f77b4')#
        # ax.bar(range(1, 98), height=support)
        ax.legend(prop={'family': font_en}, loc='lower right') #loc='best'
        # ax.legend(prop={'family': font_en, 'size':font_size}, loc='best')
        # ax.set_ylabel('F1', family=font_en, fontsize=font_size)
        # ax.set_xlabel('知识点标签', fontsize=font_size)
        ax.set_ylabel('F1', family=font_en)
        ax.set_xlabel('知识点标签')
        ax.set_xlim(0, 100)
        ax.set_xticks(range(1, 98, 6))
        ax.set_xticklabels(range(1, 98, 6))
        ax.set_title(title)
        # ax.set_title(title, fontsize=font_size)
        # ax.tick_params(labelsize=font_size)

        labels = ax.get_xticklabels() + ax.get_yticklabels()
        [label.set_fontname(font_en) for label in labels]


        plt.savefig('figs/'+title+model_name+'.png', dpi=600, bbox_inches ='tight')
        plt.show()

### draw all metrics
def draw_scatter_all(transformer_results, bert_results, supports, titles, y_labels):
    fig, axs = plt.subplots(2,3, figsize=(15,8), tight_layout=True)

    i = 0
    for transformer_y, bert_y, support, title, y_label in zip(transformer_results, bert_results, supports, titles, y_labels):
        ax = axs[int(i/3)][i%3]
        sort_zipped = sorted(zip(transformer_y, bert_y, support), key=lambda x:(x[0], x[1])) # if x[0] is equal, sort by x[1]
        transformer_y, bert_y, support = zip(*sort_zipped)
        ax.scatter(range(1, 98), transformer_y, label='transformer',marker='o', s=14.0, color='#1f77b4')
        ax.scatter(range(1, 98), bert_y,label='Bert-CNN',marker='^', s=14.0, color='#d62728')
        # ax.bar(range(1, 98), height=support)
        ax.legend(prop={'family': font_en}, loc='best')
        ax.set_ylabel(y_label, family=font_en)
        ax.set_xlabel('知识点标签')
        ax.set_xlim(0, 100)
        ax.set_xticks(range(1, 98, 4))
        ax.set_xticklabels(range(1, 98, 4))
        ax.set_title(title)
        
        labels = ax.get_xticklabels() + ax.get_yticklabels()
        [label.set_fontname(font_en) for label in labels]

        i += 1

    plt.savefig('classes_metrics.png', dpi=600, bbox_inches ='tight')
    plt.show()


def draw_map(diff_resutls, save_name):
    # 参考 http://gjcheng.fun/2021/09/28/Python%E7%BB%98%E5%9B%BE%E4%B9%8BMatplotlib%E7%BB%98%E5%88%B6%E5%85%83%E7%B4%A0%E5%91%A8%E6%9C%9F%E8%A1%A8%E7%83%AD%E5%8A%9B%E5%9B%BE/
    # cell的大小
    cell_length = 1
    # 各个cell的间隔
    cell_gap = 0.1
    # cell边框的粗细
    cell_edge_width = 0.5

    # 新建Matplotlib绘图窗口
    fig = plt.figure(figsize=(5.5, 5))
    # x、y轴的范围
    xy_length = (11, 10)

    # 获取YlOrRd颜色条
    # my_cmap = cm.get_cmap('YlOrRd')
    # my_cmap = cm.get_cmap('cool')
    my_cmap = cm.get_cmap('bwr')#coolwarm
    # pos_cmap = cm.get_cmap('Reds')
    # neg_cmap = cm.get_cmap('Blues')
    # 将plot_data数据映射为颜色，根据实际情况调整
    # norm = mpl.colors.Normalize(1, 10)
    # norm = mpl.colors.Normalize(round(min(diff_resutls), 4), round(max(diff_resutls), 4)) #
    bound = max(-round(min(diff_resutls), 4), round(max(diff_resutls), 4))
    norm = mpl.colors.Normalize(-bound, bound)
    # pos_norm = mpl.colors.Normalize(0, round(max(diff_resutls), 4))
    # neg_norm = mpl.colors.Normalize(round(min(diff_resutls), 4), 0)
    # 设置超出颜色条下界限的颜色（None为不设置，即白色）
    my_cmap.set_under('None')
    # 关联颜色条和映射
    cmmapable = cm.ScalarMappable(norm, my_cmap)
    # pos_cmmapable = cm.ScalarMappable(pos_norm, pos_cmap)
    # neg_cmmapable = cm.ScalarMappable(neg_norm, neg_cmap)
    # 绘制颜色条
    plt.colorbar(cmmapable, drawedges=False,shrink=0.6) #fraction=0.035, pad=0.01
    # plt.colorbar(pos_cmmapable, drawedges=False)
    # plt.colorbar(neg_cmmapable, drawedges=False)

    # 绘制元素周期表的cell，并填充属性和颜色
    for i, diff in enumerate(diff_resutls):

        # x, y定位cell的位置
        x = (cell_length + cell_gap) * (i%10)
        y = xy_length[1] - ((cell_length + cell_gap) * (int(i/10)))#-1

        diff = round(diff, 4)
        # if diff >= 0:
        #     my_cmap = pos_cmap
        #     norm = pos_norm
        # else:
        #     my_cmap = neg_cmap
        #     norm = neg_norm
        fill_color = my_cmap(norm(diff))
        rect = patches.Rectangle(xy=(x, y),  # 左下角坐标
                                 width=cell_length, height=cell_length,
                                 linewidth=cell_edge_width,
                                 edgecolor='k',
                                 facecolor=fill_color)
        plt.gca().add_patch(rect)

        # 在cell中添加原子序数属性
        plt.text(x + 0.04, y + 0.8,
                 i,
                 va='center', ha='left',
                 fontdict={'size': 6, 'color': 'black', 'family': 'Helvetica'})
        # 在cell中添加元素符号
        # plt.text(x + 0.5, y + 0.5,
        #          ele_symbol,
        #          va='center', ha='center',
        #          fontdict={'size': 9, 'color': 'black', 'family': 'Helvetica', 'weight': 'bold'})
        # 在cell中添加热力值
        plt.text(x + 0.5, y + 0.12,
                 diff,
                 va='center', ha='center',
                 fontdict={'size': 6, 'color': 'black', 'family': 'Helvetica'})

    # x, y 轴设置等比例（1:1）（使cell看起来是正方形）
    plt.axis('equal')
    # 关闭坐标轴
    plt.axis('off')
    # 裁剪空白边缘
    plt.tight_layout()
    # 设置x, y轴的范围
    plt.ylim(0, xy_length[1])
    plt.xlim(0, xy_length[0])

    # 将图保存为*.svg矢量格式
    plt.savefig('figs/%s.png'%save_name, dpi=600)
    # 显示绘图窗口
    plt.show()


bert_dev_precision = [0.96296296,0.93406593,0.89565217,0.96296296,0.91715976,0.90697674,0.76923077,0.77358491,0.94583333,0.94545455,0.87037037,0.99173554,0.85915493,0.92063492,0.91338583,0.9140625,0.95104895,0.93548387,0.92063492,0.94047619,0.90643275,0.7761194,0.97058824,0.94927536,0.89787234,0.91851852,0.76,0.99220779,0.86363636,0.92592593,0.83783784,0.8030303,0.98333333,0.98333333,0.87548638,0.85526316,0.99822222,0.91358025,0.97260274,0.93233083,0.93283582,0.95522388,0.96774194,0.95333333,0.95588235,0.94680851,0.9693356,0.73076923,0.84615385,1.,0.90789474,1.,0.91715976,0.98245614,0.91176471,0.91044776,0.91666667,0.97183099,0.66666667,0.41843972,0.8592233,0.93710692,0.93023256,1.,1.,0.99305556,0.99171271,0.9519774,0.57051282,0.76736672,0.96296296,0.93939394,0.98734177,0.88235294,0.95,0.99038462,0.94493783,0.89156627,0.94652406,0.95187166,0.94117647,0.87179487,1.,0.96341463,0.88,0.92592593,0.91764706,0.77358491,0.85869565,0.64678899,0.91071429,0.51351351,0.96473552,0.9725,0.99170124,0.96296296,0.91176471]
bert_dev_recall = [0.95588235,0.90425532,0.87288136,0.95588235,0.92261905,0.92125984,0.72727273,0.74545455,0.90079365,0.89655172,0.87037037,0.97959184,0.69318182,0.91338583,0.91338583,0.92125984,0.98194946,0.96666667,0.96666667,0.93307087,0.92261905,0.86666667,0.9625,0.90972222,0.87733888,0.93233083,0.86363636,0.99869281,0.86363636,0.92592593,0.7654321,0.9137931,0.9516129,0.9516129,0.91836735,0.69148936,0.99911032,0.90243902,0.92207792,0.96124031,0.96899225,0.8951049,0.96774194,0.97945205,0.95588235,1.,0.98272884,0.74509804,0.86516854,0.99820144,0.97183099,0.82352941,0.92261905,0.96551724,0.92261905,0.85915493,0.91666667,0.97183099,0.80112045,0.32596685,0.93157895,0.83240223,0.81632653,0.84615385,1.,0.94701987,0.97687075,0.96561605,0.6641791,0.7480315,0.95588235,0.95594714,0.93975904,0.81818182,0.9047619,0.98095238,0.91408935,0.90243902,0.93650794,0.94179894,0.77419355,0.57627119,0.86538462,0.88764045,0.89795918,0.92592593,0.84782609,0.74545455,0.92941176,0.55511811,0.85,0.53370787,0.94567901,0.94417476,0.9755102,0.95588235,0.92261905]
bert_dev_f1 = [0.95940959,0.91891892,0.88412017,0.95940959,0.91988131,0.9140625,0.74766355,0.75925926,0.92276423,0.92035398,0.87037037,0.98562628,0.7672956,0.91699605,0.91338583,0.91764706,0.96625222,0.95081967,0.94308943,0.93675889,0.91445428,0.81889764,0.9665272,0.92907801,0.88748686,0.92537313,0.80851064,0.99543974,0.86363636,0.92592593,0.8,0.85483871,0.96721311,0.96721311,0.89641434,0.76470588,0.99866607,0.90797546,0.94666667,0.94656489,0.95057034,0.92418773,0.96774194,0.96621622,0.95588235,0.9726776,0.97598628,0.73786408,0.85555556,0.99909991,0.93877551,0.90322581,0.91988131,0.97391304,0.91715976,0.88405797,0.91666667,0.97183099,0.72773537,0.36645963,0.89393939,0.8816568,0.86956522,0.91666667,1.,0.96949153,0.98423578,0.95874822,0.6137931,0.75757576,0.95940959,0.94759825,0.96296296,0.8490566,0.92682927,0.98564593,0.92925764,0.8969697,0.94148936,0.94680851,0.84955752,0.69387755,0.92783505,0.92397661,0.88888889,0.92592593,0.88135593,0.75925926,0.89265537,0.59745763,0.87931034,0.52341598,0.95511222,0.95812808,0.98353909,0.95940959,0.91715976]
bert_test_precision = [0.9673913,0.94174757,0.92771084,0.9673913,0.91596639,0.89403974,0.69230769,0.72,0.92131148,0.89655172,0.92727273,0.99301513,0.88073394,0.89403974,0.89333333,0.89403974,0.96368715,0.91358025,0.90243902,0.94952681,0.90495868,0.86206897,0.96415771,0.91715976,0.90909091,0.93063584,0.63636364,0.98956357,0.84878049,1.,0.86842105,0.87837838,0.98484848,0.98484848,0.91340782,0.78688525,0.99861015,0.86597938,0.97515528,0.92307692,0.91907514,0.92948718,0.95081967,0.94594595,0.9673913,0.96899225,0.97948718,0.75757576,0.83157895,1.,0.9266055,1.,0.90871369,0.90425532,0.90495868,0.91,0.91631799,0.94186047,0.67652174,0.33888889,0.90421456,0.93037975,0.98275862,1.,0.99964196,0.97727273,0.99186992,0.94239631,0.55897436,0.7902571,0.96721311,0.94845361,1.,0.90163934,0.96721311,0.99065421,0.95526696,0.86597938,0.93969849,0.93969849,0.94444444,0.69047619,0.98571429,0.90517241,0.84375,1.,0.91566265,0.70588235,0.85344828,0.60377358,0.91566265,0.42051282,0.96487603,0.9795501,0.99301513,0.9673913,0.90871369]
bert_test_recall = [0.93193717,0.97,0.93333333,0.93193717,0.95196507,0.93103448,0.64285714,0.64285714,0.93979933,0.89655172,0.94444444,0.98045977,0.78688525,0.93103448,0.92413793,0.93103448,0.96638655,0.89156627,0.89156627,0.94952681,0.95633188,0.81521739,0.95729537,0.89595376,0.89500861,0.93063584,0.63636364,1.,0.79452055,0.953125,0.79518072,0.91549296,1.,1.,0.91596639,0.75590551,0.99930459,0.94382022,0.96319018,0.9689441,0.98757764,0.86826347,0.91099476,0.98870056,0.93193717,0.99206349,0.99220779,0.68493151,0.82291667,0.99565217,0.89380531,0.82352941,0.95633188,0.94444444,0.95633188,0.9009901,0.95633188,0.97590361,0.79876797,0.33152174,0.89393939,0.8258427,0.81428571,0.88,1.,0.95555556,0.9816092,0.99271845,0.64306785,0.75549806,0.92670157,0.95172414,0.96153846,0.73333333,0.921875,0.97247706,0.91436464,0.94382022,0.93969849,0.93969849,0.91891892,0.56862745,0.92,0.88983051,0.79411765,0.953125,0.9047619,0.64285714,0.88392857,0.56973294,0.82608696,0.42931937,0.95112016,0.95991984,0.98045977,0.93193717,0.95633188]
bert_test_f1 = [0.94933333,0.95566502,0.9305136,0.94933333,0.93361884,0.91216216,0.66666667,0.67924528,0.93046358,0.89655172,0.93577982,0.98669751,0.83116883,0.91216216,0.90847458,0.91216216,0.96503497,0.90243902,0.8969697,0.94952681,0.92993631,0.83798883,0.96071429,0.90643275,0.9019948,0.93063584,0.63636364,0.99475441,0.82075472,0.976,0.83018868,0.89655172,0.99236641,0.99236641,0.91468531,0.77108434,0.99895725,0.90322581,0.9691358,0.94545455,0.95209581,0.89783282,0.93048128,0.96685083,0.94933333,0.98039216,0.98580645,0.71942446,0.82722513,0.99782135,0.90990991,0.90322581,0.93191489,0.92391304,0.92993631,0.90547264,0.93589744,0.95857988,0.73258004,0.33516484,0.89904762,0.875,0.890625,0.93617021,0.99982095,0.96629213,0.98671288,0.96690307,0.59807956,0.77248677,0.94652406,0.95008606,0.98039216,0.80882353,0.944,0.98148148,0.93436838,0.90322581,0.93969849,0.93969849,0.93150685,0.62365591,0.95172414,0.8974359,0.81818182,0.976,0.91017964,0.6728972,0.86842105,0.58625954,0.86857143,0.42487047,0.95794872,0.96963563,0.98669751,0.94933333,0.93191489]


# bert_base_dev_precision =  [0.9624060150375939, 0.9072164948453608, 0.8918918918918919, 0.9552238805970149, 0.9235668789808917, 0.9512195121951219, 0.696969696969697, 0.7076923076923077, 0.9732142857142857, 0.9607843137254902, 0.9444444444444444, 0.9904632152588556, 0.8472222222222222, 0.9512195121951219, 0.9512195121951219, 0.9512195121951219, 0.9748201438848921, 0.9622641509433962, 0.9807692307692307, 0.9595141700404858, 0.9235668789808917, 0.7538461538461538, 0.9625, 0.9225352112676056, 0.8801652892561983, 0.9044117647058824, 0.7391304347826086, 0.9870801033591732, 0.8843537414965986, 0.9230769230769231, 0.8461538461538461, 0.8852459016393442, 0.9836065573770492, 0.9836065573770492, 0.8833333333333333, 0.7875, 0.9991103202846975, 0.948051948051948, 0.935064935064935, 0.9393939393939394, 0.9323308270676691, 0.9420289855072463, 0.9536423841059603, 0.9466666666666667, 0.9481481481481482, 0.9361702127659575, 0.9759450171821306, 0.6842105263157895, 0.8555555555555555, 0.9981818181818182, 0.9041095890410958, 0.9285714285714286, 0.9294871794871795, 0.9642857142857143, 0.9235668789808917, 0.8840579710144928, 0.9294871794871795, 0.9714285714285714, 0.7329376854599406, 0.4722222222222222, 0.8356164383561644, 0.9177215189873418, 0.975609756097561, 1.0, 1.0, 0.9659863945578231, 0.990450204638472, 0.9572649572649573, 0.5923076923076923, 0.79050736497545, 0.9481481481481482, 0.9521739130434783, 0.9418604651162791, 0.7101449275362319, 0.9230769230769231, 0.9615384615384616, 0.9443478260869566, 0.948051948051948, 0.8302752293577982, 0.8341013824884793, 0.8333333333333334, 0.6862745098039216, 0.94, 0.9620253164556962, 0.9302325581395349, 0.9230769230769231, 0.8829787234042553, 0.7076923076923077, 0.8717948717948718, 0.6479750778816199, 0.7580645161290323, 0.4857142857142857, 0.9439024390243902, 0.9656862745098039, 0.9904632152588556, 0.9552238805970149, 0.9294871794871795]
# bert_base_dev_recall =  [0.9411764705882353, 0.9361702127659575, 0.8389830508474576, 0.9411764705882353, 0.8630952380952381, 0.9212598425196851, 0.8363636363636363, 0.8363636363636363, 0.8650793650793651, 0.8448275862068966, 0.9444444444444444, 0.9891156462585035, 0.6931818181818182, 0.9212598425196851, 0.9212598425196851, 0.9212598425196851, 0.9783393501805054, 0.85, 0.85, 0.9330708661417323, 0.8630952380952381, 0.8166666666666667, 0.9625, 0.9097222222222222, 0.8856548856548857, 0.924812030075188, 0.7727272727272727, 0.9986928104575163, 0.8441558441558441, 0.8888888888888888, 0.8148148148148148, 0.9310344827586207, 0.967741935483871, 0.967741935483871, 0.8653061224489796, 0.6702127659574468, 0.9991103202846975, 0.8902439024390244, 0.935064935064935, 0.9612403100775194, 0.9612403100775194, 0.9090909090909091, 0.9290322580645162, 0.9726027397260274, 0.9411764705882353, 0.9887640449438202, 0.9810017271157168, 0.7647058823529411, 0.8651685393258427, 0.987410071942446, 0.9295774647887324, 0.7647058823529411, 0.8630952380952381, 0.9310344827586207, 0.8630952380952381, 0.8591549295774648, 0.8630952380952381, 0.9577464788732394, 0.6918767507002801, 0.09392265193370165, 0.9631578947368421, 0.8100558659217877, 0.8163265306122449, 0.8461538461538461, 1.0, 0.9403973509933775, 0.9877551020408163, 0.9627507163323782, 0.8619402985074627, 0.7606299212598425, 0.9411764705882353, 0.9647577092511013, 0.9759036144578314, 0.8909090909090909, 0.8571428571428571, 0.9523809523809523, 0.9329896907216495, 0.8902439024390244, 0.9576719576719577, 0.9576719576719577, 0.7258064516129032, 0.5932203389830508, 0.9038461538461539, 0.8539325842696629, 0.8163265306122449, 0.8888888888888888, 0.9021739130434783, 0.8363636363636363, 0.8, 0.8188976377952756, 0.7833333333333333, 0.5730337078651685, 0.9555555555555556, 0.9563106796116505, 0.9891156462585035, 0.9411764705882353, 0.8630952380952381]
# bert_base_dev_f1 =  [0.9516728624535316, 0.9214659685863875, 0.8646288209606986, 0.9481481481481482, 0.8923076923076922, 0.9359999999999999, 0.7603305785123968, 0.7666666666666666, 0.9159663865546218, 0.8990825688073395, 0.9444444444444444, 0.989788972089857, 0.7625000000000001, 0.9359999999999999, 0.9359999999999999, 0.9359999999999999, 0.9765765765765766, 0.9026548672566371, 0.9107142857142857, 0.9461077844311377, 0.8923076923076922, 0.784, 0.9625000000000001, 0.916083916083916, 0.8829015544041451, 0.9144981412639406, 0.7555555555555555, 0.9928525016244314, 0.8637873754152823, 0.9056603773584906, 0.830188679245283, 0.9075630252100839, 0.975609756097561, 0.975609756097561, 0.8742268041237112, 0.7241379310344828, 0.9991103202846975, 0.9182389937106918, 0.935064935064935, 0.9501915708812261, 0.9465648854961832, 0.9252669039145908, 0.9411764705882352, 0.9594594594594594, 0.9446494464944649, 0.9617486338797814, 0.9784668389319553, 0.7222222222222222, 0.8603351955307262, 0.9927667269439421, 0.9166666666666666, 0.8387096774193549, 0.8950617283950617, 0.9473684210526316, 0.8923076923076922, 0.8714285714285713, 0.8950617283950617, 0.9645390070921985, 0.7118155619596541, 0.15668202764976957, 0.8948655256723718, 0.8605341246290801, 0.888888888888889, 0.9166666666666666, 1.0, 0.9530201342281879, 0.989100817438692, 0.96, 0.7021276595744681, 0.7752808988764044, 0.9446494464944649, 0.9584245076586434, 0.9585798816568047, 0.7903225806451614, 0.888888888888889, 0.9569377990430622, 0.9386343993085566, 0.9182389937106918, 0.8894348894348895, 0.8916256157635469, 0.7758620689655172, 0.6363636363636364, 0.9215686274509804, 0.9047619047619047, 0.8695652173913043, 0.9056603773584906, 0.8924731182795699, 0.7666666666666666, 0.834355828220859, 0.7234782608695652, 0.7704918032786884, 0.5257731958762887, 0.9496932515337423, 0.9609756097560976, 0.989788972089857, 0.9481481481481482, 0.8950617283950617]
# bert_base_test_precision =  [0.9781420765027322, 0.9142857142857143, 0.9212121212121213, 0.9781420765027322, 0.9347826086956522, 0.88, 0.5974025974025974, 0.5974025974025974, 0.9591078066914498, 0.9795918367346939, 0.875, 0.9795221843003413, 0.8518518518518519, 0.8859060402684564, 0.8807947019867549, 0.8866666666666667, 0.9723756906077348, 0.9466666666666667, 0.9466666666666667, 0.9341692789968652, 0.9347826086956522, 0.8588235294117647, 0.9614035087719298, 0.8729281767955801, 0.8975694444444444, 0.9204545454545454, 0.6666666666666666, 0.9867424242424242, 0.8787878787878788, 0.967741935483871, 0.7901234567901234, 0.9242424242424242, 0.9552238805970149, 0.9552238805970149, 0.9075144508670521, 0.7692307692307693, 0.9986101459346769, 0.8787878787878788, 0.9090909090909091, 0.9404761904761905, 0.9349112426035503, 0.9192546583850931, 0.946524064171123, 0.93048128342246, 0.9781420765027322, 0.9541984732824428, 0.9744572158365262, 0.6790123456790124, 0.7634408602150538, 0.9985358711566618, 0.9051724137931034, 1.0, 0.9347826086956522, 0.9021739130434783, 0.9347826086956522, 0.8611111111111112, 0.9347826086956522, 0.9176470588235294, 0.7300469483568075, 0.34210526315789475, 0.8606271777003485, 0.8630952380952381, 0.953125, 0.9545454545454546, 0.9992839240959541, 0.9657142857142857, 0.9795221843003413, 0.9528301886792453, 0.6008492569002123, 0.808066759388039, 0.9781420765027322, 0.9556313993174061, 0.9873417721518988, 0.6790123456790124, 0.9666666666666667, 0.963963963963964, 0.9313186813186813, 0.87, 0.8, 0.7966804979253111, 0.9117647058823529, 0.6739130434782609, 0.96, 0.954954954954955, 0.9107142857142857, 0.967741935483871, 0.78, 0.5974025974025974, 0.8584070796460177, 0.5960264900662252, 0.9080459770114943, 0.45064377682403434, 0.9463220675944334, 0.9582504970178927, 0.9795221843003413, 0.978021978021978, 0.9347826086956522]
# bert_base_test_recall =  [0.93717277486911, 0.96, 0.9212121212121213, 0.93717277486911, 0.9388646288209607, 0.9103448275862069, 0.8214285714285714, 0.8214285714285714, 0.862876254180602, 0.8275862068965517, 0.9074074074074074, 0.9896551724137931, 0.7540983606557377, 0.9103448275862069, 0.9172413793103448, 0.9172413793103448, 0.9859943977591037, 0.8554216867469879, 0.8554216867469879, 0.9400630914826499, 0.9388646288209607, 0.7934782608695652, 0.9750889679715302, 0.9132947976878613, 0.8898450946643718, 0.9364161849710982, 0.5454545454545454, 0.9990412272291467, 0.7945205479452054, 0.9375, 0.7710843373493976, 0.8591549295774648, 0.9846153846153847, 0.9846153846153847, 0.8795518207282913, 0.7874015748031497, 0.9993045897079277, 0.9775280898876404, 0.9815950920245399, 0.9813664596273292, 0.9813664596273292, 0.8862275449101796, 0.9267015706806283, 0.9830508474576272, 0.93717277486911, 0.9920634920634921, 0.990909090909091, 0.7534246575342466, 0.7395833333333334, 0.9884057971014493, 0.9292035398230089, 0.7647058823529411, 0.9388646288209607, 0.9222222222222223, 0.9388646288209607, 0.9207920792079208, 0.9388646288209607, 0.9397590361445783, 0.6386036960985626, 0.07065217391304347, 0.9356060606060606, 0.8146067415730337, 0.8714285714285714, 0.84, 0.9996418338108882, 0.9388888888888889, 0.9896551724137931, 0.9805825242718447, 0.8348082595870207, 0.7516170763260026, 0.93717277486911, 0.9655172413793104, 1.0, 0.7333333333333333, 0.90625, 0.981651376146789, 0.93646408839779, 0.9775280898876404, 0.964824120603015, 0.964824120603015, 0.8378378378378378, 0.6078431372549019, 0.96, 0.8983050847457628, 0.75, 0.9375, 0.9285714285714286, 0.8214285714285714, 0.8660714285714286, 0.8011869436201781, 0.8586956521739131, 0.5497382198952879, 0.9694501018329938, 0.9659318637274549, 0.9896551724137931, 0.9319371727748691, 0.9388646288209607]
# bert_base_test_f1 =  [0.9572192513368983, 0.9365853658536586, 0.9212121212121213, 0.9572192513368983, 0.9368191721132897, 0.8949152542372882, 0.6917293233082706, 0.6917293233082706, 0.908450704225352, 0.897196261682243, 0.8909090909090909, 0.9845626072041166, 0.7999999999999999, 0.8979591836734694, 0.8986486486486487, 0.9016949152542374, 0.9791376912378303, 0.8987341772151898, 0.8987341772151898, 0.9371069182389936, 0.9368191721132897, 0.8248587570621468, 0.9681978798586572, 0.8926553672316384, 0.8936905790838374, 0.9283667621776504, 0.6, 0.9928537398761313, 0.8345323741007193, 0.9523809523809523, 0.7804878048780488, 0.8905109489051095, 0.9696969696969696, 0.9696969696969696, 0.8933143669985775, 0.7782101167315175, 0.9989572471324296, 0.9255319148936169, 0.943952802359882, 0.9604863221884498, 0.9575757575757575, 0.9024390243902439, 0.9365079365079365, 0.956043956043956, 0.9572192513368983, 0.9727626459143969, 0.9826142949130714, 0.7142857142857143, 0.7513227513227514, 0.9934450109249818, 0.9170305676855894, 0.8666666666666666, 0.9368191721132897, 0.9120879120879122, 0.9368191721132897, 0.8899521531100479, 0.9368191721132897, 0.9285714285714286, 0.6812705366922234, 0.11711711711711711, 0.896551724137931, 0.8381502890173411, 0.9104477611940298, 0.8936170212765958, 0.9994628469113697, 0.952112676056338, 0.9845626072041166, 0.9665071770334929, 0.6987654320987654, 0.7788203753351206, 0.9572192513368983, 0.9605488850771869, 0.9936305732484078, 0.7051282051282051, 0.9354838709677419, 0.9727272727272728, 0.9338842975206612, 0.9206349206349206, 0.8747152619589977, 0.8727272727272726, 0.8732394366197184, 0.6391752577319587, 0.96, 0.925764192139738, 0.8225806451612904, 0.9523809523809523, 0.8478260869565217, 0.6917293233082706, 0.8622222222222222, 0.6835443037974684, 0.88268156424581, 0.49528301886792453, 0.9577464788732394, 0.9620758483033932, 0.9845626072041166, 0.9544235924932974, 0.9368191721132897]

# transformer_dev_precision =  [0.8376623376623377, 0.9647058823529412, 0.8672566371681416, 0.8767123287671232, 0.951048951048951, 0.7421383647798742, 0.5609756097560976, 0.5822784810126582, 0.96875, 1.0, 0.6582278481012658, 0.9985141158989599, 0.7662337662337663, 0.7662337662337663, 0.7564102564102564, 0.7564102564102564, 0.9014084507042254, 0.921875, 0.8805970149253731, 0.6622340425531915, 0.9387755102040817, 0.4076923076923077, 0.941908713692946, 0.8717948717948718, 0.8259187620889749, 0.9702970297029703, 0.3953488372093023, 0.9407407407407408, 0.7732558139534884, 0.796875, 0.8133333333333334, 0.8867924528301887, 1.0, 1.0, 0.746031746031746, 0.8636363636363636, 0.9704347826086956, 0.6666666666666666, 0.648068669527897, 0.8732394366197183, 0.8794326241134752, 0.9915254237288136, 0.7936507936507936, 0.7795698924731183, 0.927007299270073, 0.9456521739130435, 0.9485049833887044, 0.47619047619047616, 0.5510204081632653, 0.9730700179533214, 0.9761904761904762, 1.0, 0.9391891891891891, 0.9649122807017544, 0.9452054794520548, 0.9743589743589743, 0.9328859060402684, 1.0, 0.6168478260869565, 0.35984848484848486, 0.8933333333333333, 0.9435483870967742, 0.9024390243902439, 1.0, 1.0, 0.9919354838709677, 0.9985185185185185, 0.9504373177842566, 0.5647058823529412, 0.7240740740740741, 0.8496732026143791, 0.926605504587156, 0.9649122807017544, 0.875, 1.0, 0.9680851063829787, 0.903010033444816, 0.6548672566371682, 0.9166666666666666, 0.9166666666666666, 0.9473684210526315, 0.7666666666666667, 0.96, 0.9558823529411765, 0.7872340425531915, 0.7761194029850746, 0.9024390243902439, 0.5789473684210527, 0.9166666666666666, 0.5387096774193548, 0.95, 0.8157894736842105, 0.9571788413098237, 0.9326923076923077, 0.9985207100591716, 0.8387096774193549, 0.9452054794520548]
# transformer_dev_recall =  [0.9485294117647058, 0.8723404255319149, 0.8305084745762712, 0.9411764705882353, 0.8095238095238095, 0.9291338582677166, 0.8363636363636363, 0.8363636363636363, 0.8611111111111112, 0.5517241379310345, 0.9629629629629629, 0.9142857142857143, 0.6704545454545454, 0.9291338582677166, 0.9291338582677166, 0.9291338582677166, 0.924187725631769, 0.9833333333333333, 0.9833333333333333, 0.9803149606299213, 0.8214285714285714, 0.8833333333333333, 0.9458333333333333, 0.9444444444444444, 0.8877338877338877, 0.7368421052631579, 0.7727272727272727, 0.996078431372549, 0.8636363636363636, 0.9444444444444444, 0.7530864197530864, 0.8103448275862069, 0.9516129032258065, 0.9032258064516129, 0.9591836734693877, 0.40425531914893614, 0.9928825622775801, 0.9024390243902439, 0.9805194805194806, 0.9612403100775194, 0.9612403100775194, 0.8181818181818182, 0.967741935483871, 0.9931506849315068, 0.9338235294117647, 0.9775280898876404, 0.9861830742659758, 0.7843137254901961, 0.9101123595505618, 0.9748201438848921, 0.5774647887323944, 0.17647058823529413, 0.8273809523809523, 0.9482758620689655, 0.8214285714285714, 0.5352112676056338, 0.8273809523809523, 0.9154929577464789, 0.6358543417366946, 0.5248618784530387, 0.7052631578947368, 0.6536312849162011, 0.7551020408163265, 0.4230769230769231, 0.9913978494623656, 0.8145695364238411, 0.9170068027210885, 0.9340974212034384, 0.1791044776119403, 0.6157480314960629, 0.9558823529411765, 0.8898678414096917, 0.6626506024096386, 0.509090909090909, 0.5714285714285714, 0.8666666666666667, 0.9278350515463918, 0.9024390243902439, 0.9312169312169312, 0.9312169312169312, 0.5806451612903226, 0.3898305084745763, 0.9230769230769231, 0.7303370786516854, 0.7551020408163265, 0.9629629629629629, 0.8043478260869565, 0.8, 0.7764705882352941, 0.65748031496063, 0.6333333333333333, 0.17415730337078653, 0.9382716049382716, 0.941747572815534, 0.9183673469387755, 0.9558823529411765, 0.8214285714285714]
# transformer_dev_f1 =  [0.8896551724137931, 0.9162011173184357, 0.8484848484848485, 0.9078014184397163, 0.8745980707395499, 0.8251748251748252, 0.6715328467153284, 0.6865671641791045, 0.911764705882353, 0.7111111111111111, 0.7819548872180452, 0.9545454545454546, 0.715151515151515, 0.8398576512455517, 0.833922261484099, 0.833922261484099, 0.9126559714795011, 0.9516129032258064, 0.9291338582677166, 0.7904761904761906, 0.8761904761904763, 0.5578947368421052, 0.9438669438669438, 0.9066666666666667, 0.8557114228456913, 0.8376068376068375, 0.523076923076923, 0.9676190476190477, 0.8159509202453988, 0.8644067796610169, 0.782051282051282, 0.8468468468468469, 0.9752066115702479, 0.9491525423728813, 0.8392857142857143, 0.5507246376811594, 0.9815303430079155, 0.7668393782383419, 0.7803617571059431, 0.9151291512915128, 0.9185185185185185, 0.896551724137931, 0.872093023255814, 0.8734939759036144, 0.9304029304029303, 0.9613259668508287, 0.9669771380186284, 0.5925925925925926, 0.6864406779661016, 0.9739442946990117, 0.7256637168141593, 0.3, 0.8797468354430379, 0.9565217391304347, 0.8789808917197452, 0.6909090909090908, 0.8769716088328074, 0.9558823529411764, 0.6262068965517241, 0.42696629213483145, 0.788235294117647, 0.7722772277227723, 0.8222222222222222, 0.5945945945945945, 0.9956803455723542, 0.8945454545454545, 0.9560283687943262, 0.9421965317919075, 0.2719546742209632, 0.6655319148936171, 0.8996539792387543, 0.9078651685393259, 0.7857142857142856, 0.6436781609195402, 0.7272727272727273, 0.9145728643216081, 0.9152542372881355, 0.758974358974359, 0.9238845144356956, 0.9238845144356956, 0.72, 0.5168539325842697, 0.9411764705882353, 0.8280254777070064, 0.7708333333333333, 0.859504132231405, 0.8505747126436782, 0.6717557251908397, 0.8407643312101911, 0.5921985815602837, 0.7599999999999999, 0.28703703703703703, 0.9476309226932669, 0.9371980676328503, 0.9567682494684621, 0.8934707903780069, 0.8789808917197452]
# transformer_test_precision =  [0.8894472361809045, 0.9886363636363636, 0.875, 0.9210526315789473, 0.9478672985781991, 0.7307692307692307, 0.49473684210526314, 0.5581395348837209, 0.9127272727272727, 1.0, 0.6144578313253012, 0.9962311557788944, 0.7301587301587301, 0.7426900584795322, 0.7415730337078652, 0.7257142857142858, 0.9431818181818182, 0.8617021276595744, 0.8526315789473684, 0.6688311688311688, 0.9439252336448598, 0.5029585798816568, 0.96, 0.806930693069307, 0.8274193548387097, 0.9703703703703703, 0.38095238095238093, 0.9419764279238441, 0.782608695652174, 0.7901234567901234, 0.810126582278481, 0.9672131147540983, 1.0, 1.0, 0.8181818181818182, 0.8873239436619719, 0.9708276797829036, 0.6470588235294118, 0.5884476534296029, 0.8722222222222222, 0.8820224719101124, 1.0, 0.8169642857142857, 0.7435897435897436, 0.9613259668508287, 0.967741935483871, 0.9691516709511568, 0.5041322314049587, 0.4727272727272727, 0.9751098096632503, 1.0, 1.0, 0.9406392694063926, 0.9425287356321839, 0.9488372093023256, 0.9615384615384616, 0.9406392694063926, 0.9710144927536232, 0.6332665330661322, 0.3492537313432836, 0.9330143540669856, 0.9180327868852459, 0.9152542372881356, 1.0, 0.9996389891696751, 0.9863945578231292, 0.99625, 0.9495192307692307, 0.5494505494505495, 0.7758620689655172, 0.9123711340206185, 0.9508771929824561, 1.0, 0.8541666666666666, 0.9767441860465116, 0.9789473684210527, 0.8978494623655914, 0.6153846153846154, 0.8504672897196262, 0.8544600938967136, 0.9473684210526315, 0.6, 0.9358974358974359, 0.9038461538461539, 0.8448275862068966, 0.7710843373493976, 0.8255813953488372, 0.5232558139534884, 0.8585858585858586, 0.5456570155902004, 0.9696969696969697, 0.7948717948717948, 0.9600840336134454, 0.9442231075697212, 0.9950310559006211, 0.9030612244897959, 0.9395348837209302]
# transformer_test_recall =  [0.9267015706806283, 0.87, 0.8909090909090909, 0.9162303664921466, 0.8733624454148472, 0.9172413793103448, 0.8392857142857143, 0.8571428571428571, 0.8394648829431438, 0.4827586206896552, 0.9444444444444444, 0.9114942528735632, 0.7540983606557377, 0.8758620689655172, 0.9103448275862069, 0.8758620689655172, 0.9299719887955182, 0.9759036144578314, 0.9759036144578314, 0.9747634069400631, 0.8820960698689956, 0.9239130434782609, 0.9395017793594306, 0.9421965317919075, 0.882960413080895, 0.7572254335260116, 0.7272727272727273, 0.9961649089165868, 0.821917808219178, 1.0, 0.7710843373493976, 0.8309859154929577, 1.0, 1.0, 0.957983193277311, 0.49606299212598426, 0.9951321279554938, 0.9887640449438202, 1.0, 0.9751552795031055, 0.9751552795031055, 0.7485029940119761, 0.9581151832460733, 0.9830508474576272, 0.9109947643979057, 0.9523809523809523, 0.9792207792207792, 0.8356164383561644, 0.8125, 0.9652173913043478, 0.584070796460177, 0.11764705882352941, 0.8995633187772926, 0.9111111111111111, 0.8908296943231441, 0.49504950495049505, 0.8995633187772926, 0.8072289156626506, 0.648870636550308, 0.6358695652173914, 0.7386363636363636, 0.6292134831460674, 0.7714285714285715, 0.48, 0.9917621776504298, 0.8055555555555556, 0.9160919540229885, 0.9587378640776699, 0.14749262536873156, 0.6403622250970246, 0.9267015706806283, 0.9344827586206896, 0.7564102564102564, 0.5466666666666666, 0.65625, 0.8532110091743119, 0.9226519337016574, 0.9887640449438202, 0.914572864321608, 0.914572864321608, 0.7297297297297297, 0.29411764705882354, 0.9733333333333334, 0.7966101694915254, 0.7205882352941176, 1.0, 0.8452380952380952, 0.8035714285714286, 0.7589285714285714, 0.7270029673590505, 0.6956521739130435, 0.16230366492146597, 0.9307535641547862, 0.9498997995991983, 0.9206896551724137, 0.9267015706806283, 0.8820960698689956]
# transformer_test_f1 =  [0.9076923076923077, 0.925531914893617, 0.8828828828828829, 0.9186351706036746, 0.9090909090909092, 0.8134556574923547, 0.6225165562913908, 0.676056338028169, 0.8745644599303136, 0.6511627906976745, 0.7445255474452556, 0.9519807923169267, 0.7419354838709677, 0.8037974683544303, 0.8173374613003096, 0.7937500000000001, 0.9365303244005643, 0.9152542372881356, 0.9101123595505617, 0.7933247753530168, 0.9119638826185102, 0.6513409961685824, 0.9496402877697842, 0.8693333333333333, 0.8542880932556203, 0.8506493506493507, 0.5, 0.9683131407269338, 0.8017817371937639, 0.8827586206896552, 0.7901234567901234, 0.8939393939393939, 1.0, 1.0, 0.8825806451612903, 0.6363636363636364, 0.9828296703296704, 0.7822222222222223, 0.740909090909091, 0.9208211143695014, 0.9262536873156343, 0.8561643835616438, 0.8819277108433735, 0.8467153284671532, 0.9354838709677419, 0.96, 0.9741602067183461, 0.6288659793814433, 0.5977011494252874, 0.9701383831026948, 0.7374301675977654, 0.21052631578947367, 0.9196428571428571, 0.9265536723163842, 0.9189189189189189, 0.65359477124183, 0.9196428571428571, 0.881578947368421, 0.640973630831643, 0.45086705202312144, 0.8245243128964059, 0.7466666666666667, 0.8372093023255813, 0.6486486486486487, 0.9956850053937432, 0.8868501529051989, 0.9544910179640719, 0.9541062801932367, 0.23255813953488372, 0.7016300496102055, 0.9194805194805195, 0.9426086956521739, 0.8613138686131386, 0.6666666666666665, 0.7850467289719625, 0.911764705882353, 0.9100817438692098, 0.7586206896551725, 0.8813559322033898, 0.8834951456310679, 0.8244274809160306, 0.3947368421052632, 0.954248366013072, 0.8468468468468469, 0.7777777777777778, 0.870748299319728, 0.8352941176470589, 0.6338028169014085, 0.8056872037914691, 0.6234096692111959, 0.810126582278481, 0.26956521739130435, 0.9451913133402274, 0.9470529470529472, 0.9564179104477611, 0.9147286821705425, 0.9099099099099098]

model_name = 'ELECTRA'
electra_dev_precision =  [0.9432624113475178, 0.958904109589041, 0.9313725490196079, 0.9432624113475178, 0.934640522875817, 0.9186991869918699, 0.7586206896551724, 0.7719298245614035, 0.9157088122605364, 0.9444444444444444, 0.9574468085106383, 0.9875690607734806, 0.7625, 0.9112903225806451, 0.9112903225806451, 0.9112903225806451, 0.9288135593220339, 0.8983050847457628, 0.8870967741935484, 0.9166666666666666, 0.934640522875817, 0.8448275862068966, 0.9823788546255506, 0.952, 0.8979166666666667, 0.9029850746268657, 0.8235294117647058, 0.9895968790637191, 0.84375, 0.9333333333333333, 0.85, 0.8484848484848485, 0.9821428571428571, 0.9821428571428571, 0.86328125, 0.7692307692307693, 0.9991079393398751, 0.9358974358974359, 0.9645390070921985, 0.943089430894309, 0.9435483870967742, 0.8461538461538461, 0.9781021897810219, 0.9852941176470589, 0.9432624113475178, 0.9666666666666667, 0.9810671256454389, 0.6976744186046512, 0.9622641509433962, 0.9945945945945946, 0.9428571428571428, 1.0, 0.934640522875817, 1.0, 0.934640522875817, 0.9272727272727272, 0.934640522875817, 0.9577464788732394, 0.7306666666666667, 0.5, 0.9222222222222223, 0.9139072847682119, 0.8936170212765957, 0.9565217391304348, 1.0, 0.9703703703703703, 0.9889349930843707, 0.9401709401709402, 0.5583524027459954, 0.8068376068376069, 0.9432624113475178, 0.9180327868852459, 1.0, 0.6764705882352942, 0.85, 1.0, 0.9282136894824707, 0.948051948051948, 0.9351351351351351, 0.9301075268817204, 0.8604651162790697, 0.6666666666666666, 0.9767441860465116, 0.9294117647058824, 0.7916666666666666, 0.9333333333333333, 0.872093023255814, 0.7586206896551724, 0.8701298701298701, 0.6747404844290658, 0.8913043478260869, 0.4375, 0.9270588235294117, 0.9342723004694836, 0.9875690607734806, 0.9432624113475178, 0.934640522875817]
electra_dev_recall =  [0.9779411764705882, 0.7446808510638298, 0.8050847457627118, 0.9779411764705882, 0.8511904761904762, 0.889763779527559, 0.8, 0.8, 0.9484126984126984, 0.8793103448275862, 0.8333333333333334, 0.9727891156462585, 0.6931818181818182, 0.889763779527559, 0.889763779527559, 0.889763779527559, 0.9891696750902527, 0.8833333333333333, 0.9166666666666666, 0.9094488188976378, 0.8511904761904762, 0.8166666666666667, 0.9291666666666667, 0.8263888888888888, 0.896049896049896, 0.9097744360902256, 0.6363636363636364, 0.9947712418300654, 0.8766233766233766, 0.7777777777777778, 0.8395061728395061, 0.9655172413793104, 0.8870967741935484, 0.8870967741935484, 0.9020408163265307, 0.7446808510638298, 0.99644128113879, 0.8902439024390244, 0.8831168831168831, 0.8992248062015504, 0.9069767441860465, 0.8461538461538461, 0.864516129032258, 0.9178082191780822, 0.9779411764705882, 0.9775280898876404, 0.9844559585492227, 0.5882352941176471, 0.5730337078651685, 0.9928057553956835, 0.9295774647887324, 0.4117647058823529, 0.8511904761904762, 0.8793103448275862, 0.8511904761904762, 0.7183098591549296, 0.8511904761904762, 0.9577464788732394, 0.7675070028011205, 0.011049723756906077, 0.8736842105263158, 0.770949720670391, 0.8571428571428571, 0.8461538461538461, 1.0, 0.8675496688741722, 0.9727891156462585, 0.9455587392550143, 0.9104477611940298, 0.7433070866141732, 0.9779411764705882, 0.986784140969163, 0.9397590361445783, 0.8363636363636363, 0.8095238095238095, 0.9333333333333333, 0.9553264604810997, 0.8902439024390244, 0.9153439153439153, 0.9153439153439153, 0.5967741935483871, 0.5084745762711864, 0.8076923076923077, 0.8876404494382022, 0.7755102040816326, 0.7777777777777778, 0.8152173913043478, 0.8, 0.788235294117647, 0.7677165354330708, 0.6833333333333333, 0.6292134831460674, 0.9728395061728395, 0.9660194174757282, 0.9727891156462585, 0.9779411764705882, 0.8511904761904762]
electra_dev_f1 =  [0.96028880866426, 0.8383233532934131, 0.8636363636363636, 0.96028880866426, 0.8909657320872275, 0.904, 0.7787610619469026, 0.7857142857142858, 0.9317738791423003, 0.9107142857142858, 0.8910891089108911, 0.980123372172721, 0.7261904761904763, 0.900398406374502, 0.900398406374502, 0.900398406374502, 0.9580419580419581, 0.8907563025210085, 0.9016393442622951, 0.9130434782608695, 0.8909657320872275, 0.8305084745762712, 0.955032119914347, 0.8847583643122676, 0.8969823100936524, 0.906367041198502, 0.717948717948718, 0.9921773142112126, 0.8598726114649682, 0.8484848484848485, 0.84472049689441, 0.9032258064516129, 0.9322033898305085, 0.9322033898305085, 0.8822355289421157, 0.7567567567567567, 0.997772828507795, 0.9125, 0.9220338983050848, 0.9206349206349207, 0.9249011857707509, 0.8461538461538461, 0.9178082191780822, 0.9503546099290779, 0.96028880866426, 0.9720670391061451, 0.9827586206896551, 0.6382978723404256, 0.7183098591549295, 0.9936993699369938, 0.9361702127659575, 0.5833333333333334, 0.8909657320872275, 0.9357798165137614, 0.8909657320872275, 0.8095238095238096, 0.8909657320872275, 0.9577464788732394, 0.7486338797814207, 0.021621621621621623, 0.8972972972972973, 0.8363636363636364, 0.875, 0.8979591836734695, 1.0, 0.916083916083916, 0.98079561042524, 0.9428571428571428, 0.6921985815602837, 0.7737704918032787, 0.96028880866426, 0.9511677282377919, 0.9689440993788819, 0.7479674796747968, 0.8292682926829269, 0.9655172413793104, 0.9415749364944962, 0.9182389937106918, 0.9251336898395722, 0.9226666666666665, 0.7047619047619047, 0.576923076923077, 0.8842105263157894, 0.9080459770114941, 0.7835051546391752, 0.8484848484848485, 0.8426966292134831, 0.7787610619469026, 0.8271604938271604, 0.7182320441988951, 0.7735849056603774, 0.5161290322580645, 0.9493975903614458, 0.9498806682577565, 0.980123372172721, 0.96028880866426, 0.8909657320872275]
electra_test_precision =  [0.9378238341968912, 0.9733333333333334, 0.9113924050632911, 0.9378238341968912, 0.9502262443438914, 0.9014084507042254, 0.6507936507936508, 0.6612903225806451, 0.9056603773584906, 0.9423076923076923, 0.8867924528301887, 0.9871944121071012, 0.7706422018348624, 0.9084507042253521, 0.9078014184397163, 0.9020979020979021, 0.9358288770053476, 0.9487179487179487, 0.95, 0.93125, 0.9545454545454546, 0.8904109589041096, 0.9739776951672863, 0.8874172185430463, 0.9042735042735043, 0.9433962264150944, 0.8, 0.9914122137404581, 0.8590308370044053, 0.9821428571428571, 0.7906976744186046, 0.9402985074626866, 0.9692307692307692, 0.9692307692307692, 0.9014084507042254, 0.7686567164179104, 0.9986091794158554, 0.9347826086956522, 0.9675324675324676, 0.9559748427672956, 0.9559748427672956, 0.8275862068965517, 0.9754601226993865, 0.9822485207100592, 0.9378238341968912, 0.9389312977099237, 0.9845360824742269, 0.7868852459016393, 0.9019607843137255, 0.9956521739130435, 0.9306930693069307, 1.0, 0.9502262443438914, 0.9620253164556962, 0.9547511312217195, 0.90625, 0.9502262443438914, 0.9487179487179487, 0.7566371681415929, 0.5, 0.9246861924686193, 0.8838709677419355, 0.9032258064516129, 0.8333333333333334, 1.0, 0.9644970414201184, 0.9871944121071012, 0.9610705596107056, 0.583804143126177, 0.8369098712446352, 0.9378238341968912, 0.9196141479099679, 1.0, 0.675, 0.9473684210526315, 0.9805825242718447, 0.9308943089430894, 0.9347826086956522, 0.9014778325123153, 0.8970588235294118, 0.875, 0.5227272727272727, 0.9705882352941176, 0.8803418803418803, 0.8867924528301887, 0.9821428571428571, 0.9, 0.6507936507936508, 0.7916666666666666, 0.6289156626506024, 0.8795180722891566, 0.4219269102990033, 0.9155470249520153, 0.9243856332703214, 0.9871944121071012, 0.9378238341968912, 0.9547511312217195]
electra_test_recall =  [0.9476439790575916, 0.73, 0.8727272727272727, 0.9476439790575916, 0.9170305676855895, 0.8827586206896552, 0.7321428571428571, 0.7321428571428571, 0.9632107023411371, 0.8448275862068966, 0.8703703703703703, 0.9747126436781609, 0.6885245901639344, 0.8896551724137931, 0.8827586206896552, 0.8896551724137931, 0.9803921568627451, 0.891566265060241, 0.9156626506024096, 0.9400630914826499, 0.9170305676855895, 0.7065217391304348, 0.9323843416370107, 0.7745664739884393, 0.9104991394148021, 0.8670520231213873, 0.36363636363636365, 0.9961649089165868, 0.8904109589041096, 0.859375, 0.8192771084337349, 0.8873239436619719, 0.9692307692307692, 0.9692307692307692, 0.896358543417367, 0.8110236220472441, 0.9986091794158554, 0.9662921348314607, 0.9141104294478528, 0.9440993788819876, 0.9440993788819876, 0.8622754491017964, 0.8324607329842932, 0.9378531073446328, 0.9476439790575916, 0.9761904761904762, 0.9922077922077922, 0.6575342465753424, 0.4791666666666667, 0.9956521739130435, 0.831858407079646, 0.4117647058823529, 0.9170305676855895, 0.8444444444444444, 0.9213973799126638, 0.8613861386138614, 0.9170305676855895, 0.891566265060241, 0.702258726899384, 0.010869565217391304, 0.8371212121212122, 0.7696629213483146, 0.8, 0.8, 1.0, 0.9055555555555556, 0.9747126436781609, 0.9587378640776699, 0.9144542772861357, 0.7567917205692108, 0.9476439790575916, 0.9862068965517241, 0.9487179487179487, 0.72, 0.84375, 0.926605504587156, 0.9488950276243094, 0.9662921348314607, 0.9195979899497487, 0.9195979899497487, 0.7567567567567568, 0.45098039215686275, 0.88, 0.8728813559322034, 0.6911764705882353, 0.859375, 0.8571428571428571, 0.7321428571428571, 0.8482142857142857, 0.7744807121661721, 0.7934782608695652, 0.6649214659685864, 0.9714867617107943, 0.9799599198396793, 0.9747126436781609, 0.9476439790575916, 0.9213973799126638]
electra_test_f1 =  [0.9427083333333334, 0.8342857142857143, 0.891640866873065, 0.9427083333333334, 0.9333333333333333, 0.89198606271777, 0.6890756302521008, 0.6949152542372881, 0.93354943273906, 0.890909090909091, 0.8785046728971964, 0.980913823019086, 0.7272727272727273, 0.8989547038327526, 0.8951048951048951, 0.8958333333333334, 0.957592339261286, 0.9192546583850931, 0.9325153374233127, 0.9356357927786499, 0.9354120267260578, 0.7878787878787878, 0.9527272727272728, 0.8271604938271604, 0.9073756432246999, 0.9036144578313252, 0.5000000000000001, 0.9937828790052606, 0.8744394618834082, 0.9166666666666665, 0.8047337278106508, 0.9130434782608696, 0.9692307692307692, 0.9692307692307692, 0.8988764044943821, 0.789272030651341, 0.9986091794158554, 0.9502762430939227, 0.9400630914826498, 0.95, 0.95, 0.844574780058651, 0.8983050847457628, 0.9595375722543352, 0.9427083333333334, 0.9571984435797665, 0.9883570504527813, 0.7164179104477612, 0.6258503401360545, 0.9956521739130435, 0.8785046728971964, 0.5833333333333334, 0.9333333333333333, 0.8994082840236687, 0.9377777777777778, 0.883248730964467, 0.9333333333333333, 0.9192546583850931, 0.7284345047923322, 0.021276595744680847, 0.878727634194831, 0.8228228228228228, 0.8484848484848486, 0.816326530612245, 1.0, 0.9340974212034384, 0.980913823019086, 0.959902794653706, 0.7126436781609194, 0.794836956521739, 0.9427083333333334, 0.951747088186356, 0.9736842105263158, 0.6967741935483871, 0.8925619834710744, 0.9528301886792453, 0.9398084815321478, 0.9502762430939227, 0.9104477611940298, 0.9081885856079405, 0.8115942028985507, 0.48421052631578954, 0.9230769230769231, 0.8765957446808511, 0.7768595041322314, 0.9166666666666665, 0.8780487804878048, 0.6890756302521008, 0.8189655172413793, 0.6941489361702128, 0.8342857142857142, 0.5162601626016259, 0.942687747035573, 0.9513618677042802, 0.980913823019086, 0.9427083333333334, 0.9377777777777778]


dev_support =  [136, 94, 118, 136, 168, 127, 55, 55, 252, 58, 54, 735, 88, 127, 127, 127, 277, 60, 60, 254, 168, 60, 240, 144, 481, 133, 22, 765, 154, 54, 81, 58, 62, 62, 245, 94, 1124, 82, 154, 129, 129, 143, 155, 146, 136, 89, 579, 51, 89, 556, 71, 17, 168, 58, 168, 71, 168, 71, 357, 181, 190, 179, 49, 26, 2325, 151, 735, 349, 268, 635, 136, 227, 83, 55, 42, 105, 582, 82, 189, 189, 62, 59, 52, 89, 49, 54, 92, 55, 85, 254, 60, 178, 405, 412, 735, 136, 168]
min_dev, max_dev = min(dev_support), max(dev_support)
dev_support_norm = [(t-min_dev)/(max_dev-min_dev) for t in dev_support]

test_support =  [191, 100, 165, 191, 229, 145, 56, 56, 299, 58, 54, 870, 122, 145, 145, 145, 357, 83, 83, 317, 229, 92, 281, 173, 581, 173, 22, 1043, 219, 64, 83, 71, 65, 65, 357, 127, 1438, 89, 163, 161, 161, 167, 191, 177, 191, 126, 770, 73, 96, 690, 113, 17, 229, 90, 229, 101, 229, 83, 487, 184, 264, 178, 70, 25, 2792, 180, 870, 412, 339, 773, 191, 290, 78, 75, 64, 109, 724, 89, 199, 199, 74, 51, 75, 118, 68, 64, 84, 56, 112, 337, 92, 191, 491, 499, 870, 191, 229]
min_test, max_test = min(test_support), max(test_support)
test_support_norm = [(t-min_test)/(max_test-min_test) for t in test_support]


label_file = "../data/label.txt"
label_list = [w.strip() for w in open(label_file).readlines()]
# for t, b, l in zip(transformer_dev_f1, bert_dev_f1, label_list):
c = 0
dev_f1_diff = []
for t, b, l in zip(electra_dev_f1, bert_dev_f1, label_list):
    dev_f1_diff.append(b-t)
    if t>b:
        # print(t, b, t-b, l)
        c += 1
# print('dev', c)
top_diff = [t for t in sorted(zip(dev_f1_diff, label_list, dev_support), reverse=True)]
print(top_diff[:10])

c = 0
test_f1_diff = []
for t, b, l in zip(electra_test_f1, bert_test_f1, label_list):
    test_f1_diff.append(b-t)
    if t>b:
        # print(t, b, t-b, l)
        c += 1
# print('test', c)

top_diff = [t for t in sorted(zip(test_f1_diff, label_list, test_support), reverse=True)]
print(top_diff[:10])


'''
test dataset
0.9152542372881356 0.90243902 0.012815217288135616 兴奋在神经元之间的传递
0.9101123595505617 0.8969697 0.013142659550561708 兴奋在神经纤维上的传导
1.0 0.99236641 0.007633589999999968 地球的内部圈层结构及特点
1.0 0.99236641 0.007633589999999968 地球的外部圈层结构及特点
0.9265536723163842 0.92391304 0.0026406323163842282 海峡两岸关系的发展
0.45086705202312144 0.33516484 0.11570221202312142 现代生物技术专题
0.954248366013072 0.95172414 0.002524226013071895 细胞的多样性和统一性
0.6234096692111959 0.58625954 0.03715012921119587 近代史

dev dataset
0.9516129032258064 0.95081967 0.0007932332258063779 兴奋在神经元之间的传递
0.9752066115702479 0.96721311 0.007993501570247918 地球的内部圈层结构及特点
0.42696629213483145 0.36645963 0.06050666213483147 现代生物技术专题
0.9411764705882353 0.92783505 0.013341420588235287 细胞的多样性和统一性
'''
# exit()

###draw all metrics
# transformer_results = [transformer_dev_precision, transformer_dev_recall, transformer_dev_f1, transformer_test_precision, transformer_test_recall, transformer_test_f1]
# bert_results = [bert_dev_precision, bert_dev_recall, bert_dev_f1, bert_test_precision, bert_test_recall, bert_test_f1]
# supports = [dev_support_norm for _ in range(3)]+[test_support_norm for _ in range(3)]
# titles = ['在验证集上各类别知识点预测的精确度', '在验证集上各类别知识点预测的召回率', '在验证集上各类别知识点预测的F1值', 
#         '在测试集上各类别知识点预测的精确度', '在测试集上各类别知识点预测的召回率', '在测试集上各类别知识点预测的F1值',]
# y_labels = ['precision', 'recall', 'F1', 'precision', 'recall', 'F1']
# draw_scatter_all(transformer_results, bert_results, supports, titles, y_labels)

### draw f1
# # transformer_results = [transformer_dev_f1, transformer_test_f1]
# electra_results = [electra_dev_f1, electra_test_f1]
# bert_results = [bert_dev_f1, bert_test_f1]

# titles = ['在验证集上各类别知识点预测的F1值', '在测试集上各类别知识点预测的F1值']

# draw_scatter(electra_results, bert_results, titles)


draw_map(dev_f1_diff, '验证集f1_diff')
draw_map(test_f1_diff, '测试集f1_diff')

